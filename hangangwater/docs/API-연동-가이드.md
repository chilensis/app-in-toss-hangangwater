# 앱인토스 API 연동 가이드 (외부 API / mTLS)

참고: [앱인토스 개발자센터 - API 사용하기](https://developers-apps-in-toss.toss.im/development/integration-process.html)

## 요약

- **앱인토스 공식 API**(토스 로그인, 토스페이, 인앱 결제, 푸시, 프로모션 등)를 쓰려면 **mTLS 기반 서버 간(Server-to-Server) 통신**이 필수입니다.
- 미니앱(프론트)에서 **앱인토스 API를 직접 호출하는 방식은 없습니다.**  
  항상 **우리 백엔드 서버**가 mTLS 인증서로 **앱인토스 서버**에 요청을 보내는 구조입니다.

## 통신 구조

```
[미니앱 (프론트)]  ←→  [우리 서버]  ←(mTLS)→  [앱인토스 API 서버]  ←→  [토스 서버]
```

- 미니앱: 사용자 화면, 우리 서버로 일반 HTTP/HTTPS 요청 가능.
- 우리 서버: **mTLS 인증서**로 앱인토스 API(`https://apps-in-toss-api.toss.im/...`) 호출.

## mTLS가 필요한 기능

- 토스 로그인  
- 토스 페이  
- 인앱 결제  
- 기능성 푸시 / 알림  
- 프로모션(토스 포인트)  

위 기능을 쓰려면 **콘솔에서 mTLS 인증서 발급** 후, 우리 서버에 인증서/키를 설정해야 합니다.

## 한강 수온 같은 “일반 외부 API”는?

- **한강물 API**처럼 **앱인토스와 무관한 공개 API**는:
  - **미니앱(프론트)에서 직접 호출**할 수 있습니다.  
    (해당 API가 CORS를 허용하면 브라우저/웹뷰에서 그대로 요청 가능.)
  - 또는 **우리 서버를 경유**해 호출할 수도 있습니다.  
    (CORS 제한이 있거나, API 키를 숨기고 싶을 때.)
- 이런 경우 **mTLS는 필요 없습니다.**  
  mTLS는 **앱인토스 API**를 호출할 때만 필요합니다.

## 정리

| 대상 | 호출 주체 | mTLS 필요 |
|------|------------|------------|
| 앱인토스 API (로그인/결제/푸시 등) | 우리 백엔드 서버 | ✅ 필요 |
| 한강물 등 일반 외부 API | 미니앱 직접 또는 우리 서버 경유 | ❌ 불필요 |
